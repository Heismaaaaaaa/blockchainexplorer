var Autocomplete=function(){"use strict";let t=t=>t&&"object"==typeof t&&t.constructor===Object,e=(t,e)=>{for(let s in e)"addClass"===s?l(t,"add",e[s]):"removeClass"===s?l(t,"remove",e[s]):t.setAttribute(s,e[s])},s=t=>(t.firstElementChild||t).textContent.trim(),i=(t,e)=>{t.scrollTop=t.offsetTop-e.offsetHeight},h=t=>{for(let s=0;s<t.length;s++)e(t[s],{role:"option",tabindex:"-1","aria-selected":"false","aria-setsize":t.length,"aria-posinset":s})},r=function(t,e){void 0===t&&(t=!1),t&&(l(t,"remove","hidden"),p(t,"click",e))},l=(t,e,s)=>t.classList[e](s),o=(t,s)=>{e(t,{"aria-activedescendant":s||""})},a=(t,e)=>{let s=document.querySelectorAll("#"+t+" > li:not(."+e+")"),i=0;return[].slice.call(s).map(t=>i+=t.offsetHeight),i},n=(t,e,s,i)=>{let h=i.previousSibling.previousSibling,r=h?h.offsetHeight:0,l=i.nextSibling,o=l?l.offsetHeight:0;if("0"==t.getAttribute("aria-posinset")&&(i.scrollTop=t.offsetTop-a(e,s)),t.offsetTop-r<i.scrollTop)i.scrollTop=t.offsetTop-r;else{let n=t.offsetTop+5+t.offsetHeight+o-r,c=i.scrollTop+i.offsetHeight;n>c&&(i.scrollTop=n-i.offsetHeight)}},c=(t,s,i,h,r)=>{e(s,{id:i,tabIndex:"0",role:"listbox"}),e(h,{addClass:r+"-results-wrapper"}),h.insertAdjacentElement("beforeend",s),t.parentNode.insertBefore(h,t.nextSibling)},d=t=>document.createElement(t),u=t=>document.querySelector(t),p=(t,e,s)=>{t.addEventListener(e,s)},m=(t,e,s)=>{t.removeEventListener(e,s)},v={ESC:27,ENTER:13,UP:38,DOWN:40,TAB:9};return class a{constructor(a,x){var f;let{delay:L=500,clearButton:g=!0,howManyCharacters:A=1,selectFirst:b=!1,insertToInput:$=!1,showAllValues:y=!1,cache:C=!1,disableCloseOnSelect:S=!1,classGroup:B,classPreventClosing:T,classPrefix:_,ariaLabelClear:k,onSearch:E,onResults:w=()=>{},onSubmit:I=()=>{},onOpened:D=()=>{},onReset:F=()=>{},onRender:R=()=>{},onClose:W=()=>{},noResults:O=()=>{},onSelectedItem:j=()=>{}}=x;this._initial=()=>{this._clearbutton(),c(this._root,this._resultList,this._outputUl,this._resultWrap,this._prefix),p(this._root,"input",this._handleInput),this._showAll&&p(this._root,"click",this._handleInput),this._onRender({element:this._root,results:this._resultList})},this._cacheAct=(t,e)=>{this._cache&&("update"===t?this._root.setAttribute(this._cacheData,e.value):"remove"===t?this._root.removeAttribute(this._cacheData):this._root.value=this._root.getAttribute(this._cacheData))},this._handleInput=t=>{let{target:e,type:s}=t;if("true"===this._root.getAttribute("aria-expanded")&&"click"===s)return;let i=e.value.replace(this._regex,"\\$&");this._cacheAct("update",e);let h=this._showAll?0:this._delay;clearTimeout(this._timeout),this._timeout=setTimeout(()=>{this._searchItem(i.trim())},h)},this._reset=()=>{var t;e(this._root,{"aria-owns":this._id+"-list","aria-expanded":"false","aria-autocomplete":"list","aria-activedescendant":"",role:"combobox",removeClass:"auto-expanded"}),l(this._resultWrap,"remove",this._isActive),this._removeAria(u("."+this._activeList)),((null==(t=this._matches)?void 0:t.length)==0&&!this._toInput||this._showAll)&&(this._resultList.textContent=""),this._index=this._selectFirst?0:-1,this._onClose()},this._searchItem=e=>{if(this._value=e,this._onLoading(!0),r(this._clearBtn,this.destroy),0==e.length&&this._clearButton&&l(this._clearBtn,"add","hidden"),this._characters>e.length&&!this._showAll){this._onLoading();return}this._onSearch({currentValue:e,element:this._root}).then(s=>{let i=this._root.value.length,h=s.length;this._matches=Array.isArray(s)?s:JSON.parse(JSON.stringify(s)),this._onLoading(),this._error(),0==h&&0==i&&l(this._clearBtn,"add","hidden"),0==h&&i?(l(this._root,"remove","auto-expanded"),this._reset(),this._noResults({element:this._root,currentValue:e,template:this._results}),this._events()):(h>0||t(s))&&(this._index=this._selectFirst?0:-1,this._results(),this._events())}).catch(()=>{this._onLoading(),this._reset()})},this._onLoading=t=>this._root.parentNode.classList[t?"add":"remove"](this._isLoading),this._error=()=>l(this._root,"remove",this._err),this._events=()=>{p(this._root,"keydown",this._handleKeys),p(this._root,"click",this._handleShowItems),p(document,"click",this._handleDocClick),["mousemove","click"].map(t=>{p(this._resultList,t,this._handleMouse)})},this._results=t=>{e(this._root,{"aria-expanded":"true",addClass:this._prefix+"-expanded"}),this._resultList.textContent="";let s=0===this._matches.length?this._onResults({currentValue:this._value,matches:0,template:t}):this._onResults({currentValue:this._value,matches:this._matches,classGroup:this._classGroup});this._resultList.insertAdjacentHTML("afterbegin",s),l(this._resultWrap,"add",this._isActive);let r=this._classGroup?":not(."+this._classGroup+")":"";this._itemsLi=document.querySelectorAll("#"+this._outputUl+" > li"+r),h(this._itemsLi),this._onOpened({type:"results",element:this._root,results:this._resultList}),this._selectFirstElement(),i(this._resultList,this._resultWrap)},this._handleDocClick=t=>{let{target:e}=t,s=null;if((e.closest("ul")&&this._disable||e.closest("."+this._prevClosing))&&(s=!0),e.id!==this._id&&!s){this._reset();return}},this._selectFirstElement=()=>{if(this._removeAria(u("."+this._activeList)),!this._selectFirst)return;let{firstElementChild:t}=this._resultList,s=this._classGroup&&this._matches.length>0&&this._selectFirst?t.nextElementSibling:t;this._onSelected({index:this._index,element:this._root,object:this._matches[this._index]}),e(s,{id:this._selectedOption+"-0",addClass:this._activeList,"aria-selected":"true"}),o(this._root,this._selectedOption+"-0")},this._handleShowItems=()=>{this._resultList.textContent.length>0&&!l(this._resultWrap,"contains",this._isActive)&&(e(this._root,{"aria-expanded":"true",addClass:this._prefix+"-expanded"}),l(this._resultWrap,"add",this._isActive),i(this._resultList,this._resultWrap),this._selectFirstElement(),this._onOpened({type:"showItems",element:this._root,results:this._resultList}))},this._handleMouse=t=>{t.preventDefault();let{target:e,type:s}=t,i=e.closest("li"),h=null==i?void 0:i.hasAttribute("role"),r=this._activeList,o=u("."+r);!(!i||!h||e.closest("."+this._prevClosing))&&("click"===s&&this._getTextFromLi(i),"mousemove"!==s||l(i,"contains",r)||(this._removeAria(o),this._setAria(i,"mousemove"),this._index=this._indexLiSelected(i),this._onSelected({index:this._index,element:this._root,object:this._matches[this._index]})))},this._getTextFromLi=t=>{if(!t||0===this._matches.length){this._disable||this._reset();return}this._clearButton&&l(this._clearBtn,"remove","hidden"),this._root.value=s(t),this._onSubmit({index:this._index,element:this._root,object:this._matches[this._index],results:this._resultList}),this._disable||(this._removeAria(t),this._reset()),this._cacheAct("remove")},this._indexLiSelected=t=>Array.prototype.indexOf.call(this._itemsLi,t),this._handleKeys=t=>{let{keyCode:e}=t,i=l(this._resultWrap,"contains",this._isActive),h=this._matches.length+1;switch(this._selectedLi=u("."+this._activeList),e){case v.UP:case v.DOWN:if(t.preventDefault(),h<=1&&this._selectFirst||!i)return;if(e===v.UP?(this._index<0&&(this._index=h-1),this._index-=1):(this._index+=1,this._index>=h&&(this._index=0)),this._removeAria(this._selectedLi),this._index>=0&&this._index<h-1){let r=this._itemsLi[this._index];this._toInput&&i&&(this._root.value=s(r)),this._onSelected({index:this._index,element:this._root,object:this._matches[this._index]}),this._setAria(r)}else this._cacheAct(),o(this._root),this._onSelected({index:null,element:this._root,object:null});break;case v.ENTER:t.preventDefault(),this._getTextFromLi(this._selectedLi);case v.TAB:}},this._setAria=(t,s="keyboard")=>{let i=this._selectedOption+"-"+this._indexLiSelected(t);e(t,{id:i,"aria-selected":"true",addClass:this._activeList}),o(this._root,i),"mousemove"!==s&&n(t,this._outputUl,this._classGroup,this._resultList)},this._removeAria=t=>{t&&e(t,{id:"",removeClass:this._activeList,"aria-selected":"false"})},this._clearbutton=()=>{this._clearButton&&(e(this._clearBtn,{class:this._prefix+"-clear hidden",type:"button",title:this._clearBtnAriLabel,"aria-label":this._clearBtnAriLabel}),this._root.insertAdjacentElement("afterend",this._clearBtn))},this.destroy=()=>{this._clearButton&&l(this._clearBtn,"add","hidden"),this._root.value="",this._root.focus(),this._resultList.textContent="",this._reset(),this._error(),this._onReset(this._root),m(this._root,"keydown",this._handleKeys),m(this._root,"click",this._handleShowItems),m(document,"click",this._handleDocClick)},this._id=a,this._root=document.getElementById(a),this._onSearch=Boolean((f=E)&&"function"==typeof f.then)?E:t=>{let{currentValue:e,element:s}=t;return Promise.resolve(E({currentValue:e,element:s}))},this._onResults=w,this._onRender=R,this._onSubmit=I,this._onSelected=j,this._onOpened=D,this._onReset=F,this._noResults=O,this._onClose=W,this._delay=L,this._characters=A,this._clearButton=g,this._selectFirst=b,this._toInput=$,this._showAll=y,this._classGroup=B,this._prevClosing=T,this._clearBtnAriLabel=k||"clear the search query",this._prefix=_?_+"-auto":"auto",this._disable=S,this._cache=C,this._outputUl=this._prefix+"-"+this._id+"-results",this._cacheData="data-cache-auto-"+this._id,this._isLoading=this._prefix+"-is-loading",this._isActive=this._prefix+"-is-active",this._activeList=this._prefix+"-selected",this._selectedOption=this._prefix+"-selected-option",this._err=this._prefix+"-error",this._regex=/[|\\{}()[\]^$+*?.]/g,this._timeout=null,this._resultWrap=d("div"),this._resultList=d("ul"),this._clearBtn=d("button"),this._initial()}}}();